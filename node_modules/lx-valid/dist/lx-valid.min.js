/*!
 * lx-valid - v0.2.15 - 2014-07-23
 * https://github.com/litixsoft/lx-valid
 *
 * Copyright (c) 2014 Litixsoft GmbH
 * Licensed MIT
 */

!function(a){"use strict";function b(a){if(null===a)return"null";if(a&&(1===a.nodeType||9===a.nodeType))return"element";var b=Object.prototype.toString.call(a),c=b.match(/\[object (.*?)\]/)[1].toLowerCase();if("number"===c){if(isNaN(a))return"nan";if(!isFinite(a))return"infinity"}return c}function c(a,b,f){f=d({},c.defaults,f),f.trim===!0&&(String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}));var g=[];if(b.items){var h=b,i={array:a};b&&(h={properties:{array:b}}),e(i,h,f,g)}else e(a,b,f,g);return{valid:!g.length,errors:g}}function d(a){for(var b=Array.prototype.slice.call(arguments,1);b.length;){var c=b.shift();if(c){if("object"!=typeof c)throw new TypeError("mixin non-object");for(var d in c)c.hasOwnProperty(d)&&(a[d]=c[d])}}return a}function e(a,b,c,d){var e,g,i=Object.keys(a),j=[];if(b.properties){e=b.properties;for(g in e)e.hasOwnProperty(g)&&(j.push(g),f(a,a[g],g,e[g],c,d))}if(b.patternProperties){e=b.patternProperties;for(g in e)if(e.hasOwnProperty(g)){var k=new RegExp(g);for(var l in a)a.hasOwnProperty(l)&&(j.push(l),null!==k.exec(l)&&f(a,a[l],g,e[g],c,d))}}if(c.deleteUnknownProperties){e=b.properties?Object.keys(b.properties):[],e=e.concat(b.patternProperties?Object.keys(b.patternProperties):[]);for(g in a)a.hasOwnProperty(g)&&-1===e.indexOf(g)&&delete a[g]}if(void 0!==b.additionalProperties){var m,n,o=i.filter(function(a){return-1===j.indexOf(a)});if(b.additionalProperties===!1&&o.length>0)for(m=0,n=o.length;n>m;m++)h("additionalProperties",o[m],a[o[m]],!1,d);else if("object"==typeof b.additionalProperties&&o.length>0)for(m=0,n=o.length;n>m;m++)f(a,a[o[m]],o[m],b.unvisitedProperties,c,d)}}function f(a,d,j,k,l,m){function n(b,c,d){void 0===k[b]||d(c,k[b],a)||h(b,j,c,k,m)}var o,p,q,r,s;if("string"==typeof d&&l.strictRequired===!0&&k.required){var t=l.trim===!0?d.trim():d;if(""===t)return h("required",j,void 0,k,m)}if(void 0===d){if(void 0===k["default"]||!l.addMissingDefaults)return k.required&&"any"!==k.type?h("required",j,void 0,k,m):void n("conform",d,function(a,b,c){return b(a,c)});a[j]=d="function"==typeof k["default"]?k["default"]():k["default"],n("conform",d,function(a,b,c){return b(a,c)})}if(l.cast&&(("integer"===k.type||"number"===k.type||"float"===k.type)&&(null===d||"boolean"==typeof d||isNaN(+d)||(d=+d,a[j]=d)),"boolean"===k.type&&(("true"===d||"1"===d||1===d)&&(d=!0,a[j]=d),("false"===d||"0"===d||0===d)&&(d=!1,a[j]=d))),k.format&&l.validateFormats&&"string"==typeof d){var u=i(k.format)?k.format:[k.format];for(p=!1,r=0,s=u.length;s>r;r++)if(o=u[r].toLowerCase().trim(),l.validateFormatExtensions&&(q=c.formatExtensions[o]),q||(q=c.formats[o]),q){if(q.test(d)){if(l.convert&&"function"==typeof l.convert)if(i(a[j])){var v=a[j].indexOf(d);a[j][v]=l.convert(o,d)}else a[j]=l.convert(o,d);p=!0;break}p=!1}else if(l.validateFormatsStrict){p=!1;break}if(!p)return h("format",j,d,k,m)}if(k["enum"])if("array"===k.type&&i(d)){for(r=0;r<d.length;r++)if(-1===k["enum"].indexOf(d[r])){h("enum",j,d,k,m);break}}else-1===k["enum"].indexOf(d)&&h("enum",j,d,k,m);if("string"==typeof k.dependencies&&void 0===a[k.dependencies]&&h("dependencies",j,null,k,m),i(k.dependencies))for(r=0,s=k.dependencies.length;s>r;r++)void 0===a[k.dependencies[r]]&&h("dependencies",j,null,k,m);"object"==typeof k.dependencies&&e(a,k.dependencies,l,m),g(d,k.type,function(c,g){if(c)return h("type",j,b(d),k,m);switch(n("conform",d,function(a,b,c){return b(a,c)}),g||(i(d)?"array":typeof d)){case"string":if(l.trim===!0)if(i(a[j])){var o=a[j].indexOf(d);"string"==typeof a[j][o]&&(a[j][o]=d.trim())}else"string"==typeof a[j]&&(a[j]=d.trim());n("minLength",d.length,function(a,b){return a>=b}),n("maxLength",d.length,function(a,b){return b>=a}),n("pattern",d,function(a,b){return b="string"==typeof b?b=new RegExp(b):b,b.test(a)});break;case"integer":case"number":n("minimum",d,function(a,b){return a>=b}),n("maximum",d,function(a,b){return b>=a}),n("exclusiveMinimum",d,function(a,b){return a>b}),n("exclusiveMaximum",d,function(a,b){return b>a}),n("divisibleBy",d,function(a,b){var c=Math.max((a-Math.floor(a)).toString().length-2,(b-Math.floor(b)).toString().length-2);return c=c>0?Math.pow(10,c):1,a*c%(b*c)===0});break;case"array":n("items",d,function(b,c){for(var d=0,e=b.length;e>d;d++)f(a,b[d],j,c,l,m);return!0}),n("minItems",d,function(a,b){return a.length>=b}),n("maxItems",d,function(a,b){return a.length<=b}),n("uniqueItems",d,function(a){for(var b={},c=0,d=a.length;d>c;c++){var e=JSON.stringify(a[c]);if(b[e])return!1;b[e]=!0}return!0});break;case"object":(k.properties||k.patternProperties||k.additionalProperties)&&e(d,k,l,m)}})}function g(a,b,c){var d=i(b)?b:[b];if(void 0===b)return c(null,b);for(var e=0,f=d.length;f>e;e++)if(b=d[e].toLowerCase().trim(),"string"===b?"string"==typeof a:"array"===b?i(a):"object"===b?a&&"object"==typeof a&&!i(a):"number"===b?"number"==typeof a:"integer"===b?"number"==typeof a&&~~a===a:"float"===b?"number"==typeof a&&new RegExp(/^[\-\+]?\b(\d+[.]\d+$)$/).exec(a):"null"===b?null===a:"boolean"===b?"boolean"==typeof a:"date"===b?"[object Date]"===Object.prototype.toString.call(a):"regexp"===b?"[object RegExp]"===Object.prototype.toString.call(a):"any"===b?"undefined"!=typeof a:!1)return c(null,b);c(!0)}function h(a,b,d,e,f){var g={expected:e[a],attribute:a,property:b},h=e.messages&&e.messages[a]||e.message||c.messages[a]||"no default message";h=h.replace(/%\{([a-z]+)\}/gi,function(a,b){return g[b.toLowerCase()]||""}),f.push({attribute:a,property:b,expected:e[a],actual:d,message:h})}function i(a){var b=typeof a;return"object"===b&&a&&"number"==typeof a.length&&!a.propertyIsEnumerable("length")&&"function"==typeof a.splice?!0:!1}c.defaults={validateFormats:!0,validateFormatsStrict:!1,validateFormatExtensions:!0,addMissingDefaults:!1,deleteUnknownProperties:!1,trim:!1,strictRequired:!1},c.messages={required:"is required",minLength:"is too short (minimum is %{expected} characters)",maxLength:"is too long (maximum is %{expected} characters)",pattern:"invalid input",minimum:"must be greater than or equal to %{expected}",maximum:"must be less than or equal to %{expected}",exclusiveMinimum:"must be greater than %{expected}",exclusiveMaximum:"must be less than %{expected}",divisibleBy:"must be divisible by %{expected}",minItems:"must contain more than %{expected} items",maxItems:"must contain less than %{expected} items",uniqueItems:"must hold a unique set of values",format:"is not a valid %{expected}",conform:"must conform to given constraint",type:"must be of %{expected} type",additionalProperties:"must not exist"},c.messages["enum"]="must be present in given enumerator",c.formats={email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,"ip-address":/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/i,ipv6:/^([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}$/,"date-time":/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:.\d{1,3})?Z$/,date:/^\d{4}-\d{2}-\d{2}$/,time:/^\d{2}:\d{2}:\d{2}$/,color:/^#[a-z0-9]{6}|#[a-z0-9]{3}|(?:rgb\(\s*(?:[+-]?\d+%?)\s*,\s*(?:[+-]?\d+%?)\s*,\s*(?:[+-]?\d+%?)\s*\))aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow$/i,"host-name":/^(([a-zA-Z]|[a-zA-Z][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z]|[A-Za-z][A-Za-z0-9\-]*[A-Za-z0-9])/,"utc-millisec":{test:function(a){return"number"==typeof a&&a>=0}},regex:{test:function(a){try{new RegExp(a)}catch(b){return!1}return!0}}},c.formatExtensions={url:/^(https?|ftp|git):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},a.validate=c,a.mixin=d}("undefined"==typeof window?module.exports:window.json=window.json||{}),function(){function a(a){var c=!1;return function(){if(c)throw new Error("Callback was already called.");c=!0,a.apply(b,arguments)}}var b,c,d={};b=this,null!=b&&(c=b.async),d.noConflict=function(){return b.async=c,d};var e=Object.prototype.toString,f=Array.isArray||function(a){return"[object Array]"===e.call(a)},g=function(a,b){if(a.forEach)return a.forEach(b);for(var c=0;c<a.length;c+=1)b(a[c],c,a)},h=function(a,b){if(a.map)return a.map(b);var c=[];return g(a,function(a,d,e){c.push(b(a,d,e))}),c},i=function(a,b,c){return a.reduce?a.reduce(b,c):(g(a,function(a,d,e){c=b(c,a,d,e)}),c)},j=function(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b};"undefined"!=typeof process&&process.nextTick?(d.nextTick=process.nextTick,d.setImmediate="undefined"!=typeof setImmediate?function(a){setImmediate(a)}:d.nextTick):"function"==typeof setImmediate?(d.nextTick=function(a){setImmediate(a)},d.setImmediate=d.nextTick):(d.nextTick=function(a){setTimeout(a,0)},d.setImmediate=d.nextTick),d.each=function(b,c,d){function e(a){a?(d(a),d=function(){}):(f+=1,f>=b.length&&d())}if(d=d||function(){},!b.length)return d();var f=0;g(b,function(b){c(b,a(e))})},d.forEach=d.each,d.eachSeries=function(a,b,c){if(c=c||function(){},!a.length)return c();var d=0,e=function(){b(a[d],function(b){b?(c(b),c=function(){}):(d+=1,d>=a.length?c():e())})};e()},d.forEachSeries=d.eachSeries,d.eachLimit=function(a,b,c,d){var e=k(b);e.apply(null,[a,c,d])},d.forEachLimit=d.eachLimit;var k=function(a){return function(b,c,d){if(d=d||function(){},!b.length||0>=a)return d();var e=0,f=0,g=0;!function h(){if(e>=b.length)return d();for(;a>g&&f<b.length;)f+=1,g+=1,c(b[f-1],function(a){a?(d(a),d=function(){}):(e+=1,g-=1,e>=b.length?d():h())})}()}},l=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[d.each].concat(b))}},m=function(a,b){return function(){var c=Array.prototype.slice.call(arguments);return b.apply(null,[k(a)].concat(c))}},n=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[d.eachSeries].concat(b))}},o=function(a,b,c,d){if(b=h(b,function(a,b){return{index:b,value:a}}),d){var e=[];a(b,function(a,b){c(a.value,function(c,d){e[a.index]=d,b(c)})},function(a){d(a,e)})}else a(b,function(a,b){c(a.value,function(a){b(a)})})};d.map=l(o),d.mapSeries=n(o),d.mapLimit=function(a,b,c,d){return p(b)(a,c,d)};var p=function(a){return m(a,o)};d.reduce=function(a,b,c,e){d.eachSeries(a,function(a,d){c(b,a,function(a,c){b=c,d(a)})},function(a){e(a,b)})},d.inject=d.reduce,d.foldl=d.reduce,d.reduceRight=function(a,b,c,e){var f=h(a,function(a){return a}).reverse();d.reduce(f,b,c,e)},d.foldr=d.reduceRight;var q=function(a,b,c,d){var e=[];b=h(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c&&e.push(a),b()})},function(){d(h(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};d.filter=l(q),d.filterSeries=n(q),d.select=d.filter,d.selectSeries=d.filterSeries;var r=function(a,b,c,d){var e=[];b=h(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c||e.push(a),b()})},function(){d(h(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};d.reject=l(r),d.rejectSeries=n(r);var s=function(a,b,c,d){a(b,function(a,b){c(a,function(c){c?(d(a),d=function(){}):b()})},function(){d()})};d.detect=l(s),d.detectSeries=n(s),d.some=function(a,b,c){d.each(a,function(a,d){b(a,function(a){a&&(c(!0),c=function(){}),d()})},function(){c(!1)})},d.any=d.some,d.every=function(a,b,c){d.each(a,function(a,d){b(a,function(a){a||(c(!1),c=function(){}),d()})},function(){c(!0)})},d.all=d.every,d.sortBy=function(a,b,c){d.map(a,function(a,c){b(a,function(b,d){b?c(b):c(null,{value:a,criteria:d})})},function(a,b){if(a)return c(a);var d=function(a,b){var c=a.criteria,d=b.criteria;return d>c?-1:c>d?1:0};c(null,h(b.sort(d),function(a){return a.value}))})},d.auto=function(a,b){b=b||function(){};var c=j(a),e=c.length;if(!e)return b();var h={},k=[],l=function(a){k.unshift(a)},m=function(a){for(var b=0;b<k.length;b+=1)if(k[b]===a)return void k.splice(b,1)},n=function(){e--,g(k.slice(0),function(a){a()})};l(function(){if(!e){var a=b;b=function(){},a(null,h)}}),g(c,function(c){var e=f(a[c])?a[c]:[a[c]],k=function(a){var e=Array.prototype.slice.call(arguments,1);if(e.length<=1&&(e=e[0]),a){var f={};g(j(h),function(a){f[a]=h[a]}),f[c]=e,b(a,f),b=function(){}}else h[c]=e,d.setImmediate(n)},o=e.slice(0,Math.abs(e.length-1))||[],p=function(){return i(o,function(a,b){return a&&h.hasOwnProperty(b)},!0)&&!h.hasOwnProperty(c)};if(p())e[e.length-1](k,h);else{var q=function(){p()&&(m(q),e[e.length-1](k,h))};l(q)}})},d.retry=function(a,b,c){var e=5,f=[];"function"==typeof a&&(c=b,b=a,a=e),a=parseInt(a,10)||e;var g=function(e,g){for(var h=function(a,b){return function(c){a(function(a,d){c(!a||b,{err:a,result:d})},g)}};a;)f.push(h(b,!(a-=1)));d.series(f,function(a,b){b=b[b.length-1],(e||c)(b.err,b.result)})};return c?g():g},d.waterfall=function(a,b){if(b=b||function(){},!f(a)){var c=new Error("First argument to waterfall must be an array of functions");return b(c)}if(!a.length)return b();var e=function(a){return function(c){if(c)b.apply(null,arguments),b=function(){};else{var f=Array.prototype.slice.call(arguments,1),g=a.next();f.push(g?e(g):b),d.setImmediate(function(){a.apply(null,f)})}}};e(d.iterator(a))()};var t=function(a,b,c){if(c=c||function(){},f(b))a.map(b,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},c);else{var d={};a.each(j(b),function(a,c){b[a](function(b){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),d[a]=e,c(b)})},function(a){c(a,d)})}};d.parallel=function(a,b){t({map:d.map,each:d.each},a,b)},d.parallelLimit=function(a,b,c){t({map:p(b),each:k(b)},a,c)},d.series=function(a,b){if(b=b||function(){},f(a))d.mapSeries(a,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},b);else{var c={};d.eachSeries(j(a),function(b,d){a[b](function(a){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),c[b]=e,d(a)})},function(a){b(a,c)})}},d.iterator=function(a){var b=function(c){var d=function(){return a.length&&a[c].apply(null,arguments),d.next()};return d.next=function(){return c<a.length-1?b(c+1):null},d};return b(0)},d.apply=function(a){var b=Array.prototype.slice.call(arguments,1);return function(){return a.apply(null,b.concat(Array.prototype.slice.call(arguments)))}};var u=function(a,b,c,d){var e=[];a(b,function(a,b){c(a,function(a,c){e=e.concat(c||[]),b(a)})},function(a){d(a,e)})};d.concat=l(u),d.concatSeries=n(u),d.whilst=function(a,b,c){a()?b(function(e){return e?c(e):void d.whilst(a,b,c)}):c()},d.doWhilst=function(a,b,c){a(function(e){if(e)return c(e);var f=Array.prototype.slice.call(arguments,1);b.apply(null,f)?d.doWhilst(a,b,c):c()})},d.until=function(a,b,c){a()?c():b(function(e){return e?c(e):void d.until(a,b,c)})},d.doUntil=function(a,b,c){a(function(e){if(e)return c(e);var f=Array.prototype.slice.call(arguments,1);b.apply(null,f)?c():d.doUntil(a,b,c)})},d.queue=function(b,c){function e(a,b,c,e){return a.started||(a.started=!0),f(b)||(b=[b]),0==b.length?d.setImmediate(function(){a.drain&&a.drain()}):void g(b,function(b){var f={data:b,callback:"function"==typeof e?e:null};c?a.tasks.unshift(f):a.tasks.push(f),a.saturated&&a.tasks.length===a.concurrency&&a.saturated(),d.setImmediate(a.process)})}void 0===c&&(c=1);var h=0,i={tasks:[],concurrency:c,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(a,b){e(i,a,!1,b)},kill:function(){i.drain=null,i.tasks=[]},unshift:function(a,b){e(i,a,!0,b)},process:function(){if(!i.paused&&h<i.concurrency&&i.tasks.length){var c=i.tasks.shift();i.empty&&0===i.tasks.length&&i.empty(),h+=1;var d=function(){h-=1,c.callback&&c.callback.apply(c,arguments),i.drain&&i.tasks.length+h===0&&i.drain(),i.process()},e=a(d);b(c.data,e)}},length:function(){return i.tasks.length},running:function(){return h},idle:function(){return i.tasks.length+h===0},pause:function(){i.paused!==!0&&(i.paused=!0,i.process())},resume:function(){i.paused!==!1&&(i.paused=!1,i.process())}};return i},d.priorityQueue=function(a,b){function c(a,b){return a.priority-b.priority}function e(a,b,c){for(var d=-1,e=a.length-1;e>d;){var f=d+(e-d+1>>>1);c(b,a[f])>=0?d=f:e=f-1}return d}function h(a,b,h,i){return a.started||(a.started=!0),f(b)||(b=[b]),0==b.length?d.setImmediate(function(){a.drain&&a.drain()}):void g(b,function(b){var f={data:b,priority:h,callback:"function"==typeof i?i:null};a.tasks.splice(e(a.tasks,f,c)+1,0,f),a.saturated&&a.tasks.length===a.concurrency&&a.saturated(),d.setImmediate(a.process)})}var i=d.queue(a,b);return i.push=function(a,b,c){h(i,a,b,c)},delete i.unshift,i},d.cargo=function(a,b){var c=!1,e=[],i={tasks:e,payload:b,saturated:null,empty:null,drain:null,drained:!0,push:function(a,c){f(a)||(a=[a]),g(a,function(a){e.push({data:a,callback:"function"==typeof c?c:null}),i.drained=!1,i.saturated&&e.length===b&&i.saturated()}),d.setImmediate(i.process)},process:function j(){if(!c){if(0===e.length)return i.drain&&!i.drained&&i.drain(),void(i.drained=!0);var d="number"==typeof b?e.splice(0,b):e.splice(0,e.length),f=h(d,function(a){return a.data});i.empty&&i.empty(),c=!0,a(f,function(){c=!1;var a=arguments;g(d,function(b){b.callback&&b.callback.apply(null,a)}),j()})}},length:function(){return e.length},running:function(){return c}};return i};var v=function(a){return function(b){var c=Array.prototype.slice.call(arguments,1);b.apply(null,c.concat([function(b){var c=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(b?console.error&&console.error(b):console[a]&&g(c,function(b){console[a](b)}))}]))}};d.log=v("log"),d.dir=v("dir"),d.memoize=function(a,b){var c={},e={};b=b||function(a){return a};var f=function(){var f=Array.prototype.slice.call(arguments),g=f.pop(),h=b.apply(null,f);h in c?d.nextTick(function(){g.apply(null,c[h])}):h in e?e[h].push(g):(e[h]=[g],a.apply(null,f.concat([function(){c[h]=arguments;var a=e[h];delete e[h];for(var b=0,d=a.length;d>b;b++)a[b].apply(null,arguments)}])))};return f.memo=c,f.unmemoized=a,f},d.unmemoize=function(a){return function(){return(a.unmemoized||a).apply(null,arguments)}},d.times=function(a,b,c){for(var e=[],f=0;a>f;f++)e.push(f);return d.map(e,b,c)},d.timesSeries=function(a,b,c){for(var e=[],f=0;a>f;f++)e.push(f);return d.mapSeries(e,b,c)},d.seq=function(){var a=arguments;return function(){var b=this,c=Array.prototype.slice.call(arguments),e=c.pop();d.reduce(a,c,function(a,c,d){c.apply(b,a.concat([function(){var a=arguments[0],b=Array.prototype.slice.call(arguments,1);d(a,b)}]))},function(a,c){e.apply(b,[a].concat(c))})}},d.compose=function(){return d.seq.apply(null,Array.prototype.reverse.call(arguments))};var w=function(a,b){var c=function(){var c=this,d=Array.prototype.slice.call(arguments),e=d.pop();return a(b,function(a,b){a.apply(c,d.concat([b]))},e)};if(arguments.length>2){var d=Array.prototype.slice.call(arguments,2);return c.apply(this,d)}return c};d.applyEach=l(w),d.applyEachSeries=n(w),d.forever=function(a,b){function c(d){if(d){if(b)return b(d);throw d}a(c)}c()},"undefined"!=typeof module&&module.exports?module.exports=d:"undefined"!=typeof define&&define.amd?define([],function(){return d}):b.async=d}(),function(a,b,c){"use strict";function d(a,c){if("string"!=typeof a||!(c instanceof RegExp))throw new Error("extensionName or extensionValue undefined or not correct type");if(b.validate.formats.hasOwnProperty(a)||b.validate.formats.hasOwnProperty(a)){var d="extensionName: "+a+" already exists in formatExtensions.";throw new Error(d)}b.validate.formatExtensions[a]=c}function e(a,c){return String(b.validate.messages[a].replace("%{expected}",c))}function f(a,b,c){var d={attribute:"",expected:"",actual:"",message:""};return d.attribute=a,d.expected=b,d.actual=c,d.message=e(a,b),d}function g(a){var b={valid:!0,errors:[]};return null!==a&&(b.valid=!1,b.errors.push(a)),b}function h(a){for(var b={},c=0,d=a.length;d>c;c++){var e=JSON.stringify(a[c]);if(b[e])return!1;b[e]=!0}return!0}function i(){var a={};return a.email=function(a){return g(b.validate.formats.email.test(a)?null:f("format","email",a))},a.ipAddress=function(a){return g(b.validate.formats["ip-address"].test(a)?null:f("format","ip-address",a))},a.ipv6=function(a){return g(b.validate.formats.ipv6.test(a)?null:f("format","ipv6",a))},a.dateTime=function(a){return g(b.validate.formats["date-time"].test(a)?null:f("format","date-time",a))},a.date=function(a){return g(b.validate.formats.date.test(a)?null:f("format","date",a))},a.time=function(a){return g(b.validate.formats.time.test(a)?null:f("format","time",a))},a.color=function(a){return g(b.validate.formats.color.test(a)?null:f("format","color",a))},a.hostName=function(a){return g(b.validate.formats["host-name"].test(a)?null:f("format","host-name",a))},a.utcMillisec=function(a){return g(b.validate.formats["utc-millisec"].test(a)?null:f("format","utc-millisec",a))},a.regex=function(a){return g(a instanceof RegExp?null:f("format","regex",a))},a.url=function(a){return g(b.validate.formatExtensions.url.test(a)?null:f("format","url",a))},a.mongoId=function(a){return g(b.validate.formatExtensions["mongo-id"].test(a)?null:f("format","mongoId",a))},a.numberFloat=function(a){return g(b.validate.formatExtensions["number-float"].test(a)?null:f("format","float",a))},a.empty=function(a){return g(b.validate.formatExtensions.empty.test(a)?null:f("format","empty",a))},a}function j(){var a={};return a.string=function(a){return g("string"!=typeof a?f("type","string",a):null)},a.number=function(a){return g("number"!=typeof a?f("type","number",a):null)},a["boolean"]=function(a){return g("boolean"!=typeof a?f("type","boolean",a):null)},a.object=function(a){return g("object"!=typeof a?f("type","object",a):null)},a.undefined=function(a){return g("undefined"!=typeof a?f("type","undefined",a):null)},a.integer=function(a){return g("number"!=typeof a||~~a!==a?f("type","integer",a):null)},a["float"]=function(a){return g("number"==typeof a&&new RegExp(/^[\-\+]?\b(\d+[.]\d+$)$/).exec(a)?null:f("type","float",a))},a.array=function(a){return g(Array.isArray(a)?null:f("type","array",a))},a.date=function(a){return g(a instanceof Date?null:f("type","Date",a))},a.regexp=function(a){return g(a instanceof RegExp?null:f("type","RegExp",a))},a["null"]=function(a){return g(null!==a?f("type","null",a):null)},a.mongoId=function(a){return g(b.validate.formatExtensions["mongo-id"].test((a||"").toString())?null:f("type","mongoId",a))},a}function k(){var a={};return a.maxLength=function(a,b){return g(!Array.isArray(a)&&"string"!=typeof a||"number"!=typeof b?new Error("rules.maxLength(fail): value must be a string or array, max must be a number"):a.length>b?f("maxLength",b,a):null)},a.minLength=function(a,b){return g(!Array.isArray(a)&&"string"!=typeof a||"number"!=typeof b?new Error("rules.minLength(fail): value must be a string or array, min must be a number"):a.length<b?f("minLength",b,a):null)},a.minimum=function(a,b){return g("number"!=typeof a||"number"!=typeof b?new Error("rules.minimum(fail): value must be a number, min must be a number"):b>a?f("minimum",b,a):null)},a.maximum=function(a,b){return g("number"!=typeof a||"number"!=typeof b?new Error("rules.maximum(fail): value must be a number, max must be a number"):a>b?f("maximum",b,a):null)},a.exclusiveMinimum=function(a,b){return g("number"!=typeof a||"number"!=typeof b?new Error("rules.exclusiveMinimum(fail): value must be a number, min must be a number"):b>=a?f("exclusiveMinimum",b,a):null)},a.exclusiveMaximum=function(a,b){return g("number"!=typeof a||"number"!=typeof b?new Error("rules.exclusiveMaximum(fail): value must be a number, max must be a number"):a>=b?f("exclusiveMinimum",b,a):null)},a.divisibleBy=function(a,b){if("number"!=typeof a||"number"!=typeof b)return g(new Error("rules.divisibleBy(fail): value must be a number, div must be a number"));var c=Math.max((a-Math.floor(a)).toString().length-2,(b-Math.floor(b)).toString().length-2);return c=c>0?Math.pow(10,c):1,g(a*c%(b*c)!==0?f("divisibleBy",b,a):null)},a.minItems=function(a,b){return g(Array.isArray(a)&&"number"==typeof b?a.length<b?f("minItems",b,a.length):null:new Error("rules.minItems(fail): value must be a array, min must be a number"))},a.maxItems=function(a,b){return g(Array.isArray(a)&&"number"==typeof b?a.length>b?f("maxItems",b,a.length):null:new Error("rules.maxItems(fail): value must be a array, max must be a number"))},a.uniqueItems=function(a){return g(Array.isArray(a)?h(a)?null:f("uniqueItems",a,!0):new Error("rules.uniqueItems(fail): value must be a array"))},a["enum"]=function(a,b){return g("undefined"!=typeof a&&Array.isArray(b)?-1===b.indexOf(a)?f("enum",b,a):null:new Error("rules.enum(fail): value must be a defined and enum mus be a array"))},a}function l(){var a={},b=[];return a.register=function(a,c){b.push(function(b){a(c,b)})},a.exec=function(a,d){c.parallel(b,function(c,e){if(b=[],c)d(c);else{var f,g;for(f=0,g=e.length;g>f;f+=1)e[f].valid||(a.valid=!1,a.errors.push(e[f].errors[0]));d(null,a)}})},a}function m(b){return b=b||{},function(c,d,e){if(c=c||{},e=e||{},e.isUpdate=e.isUpdate||!1,e.isUpdate){var f,g=Object.keys(d.properties),h=g.length;for(f=0;h>f;f++)c.hasOwnProperty(g[f])||(d.properties[g[f]].required=!1)}for(var i in b)b.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(e[i]=b[i]);return a.validate(c,d,e)}}b.validate.formatExtensions["mongo-id"]=/^[0-9a-fA-F]{8}[0-9a-fA-F]{6}[0-9a-fA-F]{4}[0-9a-fA-F]{6}$/,b.validate.formatExtensions["number-float"]=/^[\-\+]?\b(\d+[.]\d+$)$/,b.validate.formatExtensions.empty=/^$/,a.validate=b.validate,a.mixin=b.mixin,a.extendFormat=d,a.formats=i(),a.types=j(),a.rules=k(),a.asyncValidate=l(),a.getValidationFunction=m}("undefined"==typeof window?module.exports:window.lxvalid=window.lxvalid||{},"undefined"==typeof window?require("./revalidator"):window.json,"undefined"==typeof window?require("async"):window.async);